<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
lang="en" xml:lang="en">
<head>
<title>TODO-asep</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2012/01/23 02:55:42 PM"/>
<meta name="author" content="lken"/>
<style type="text/css">
  html {
	font-family: Times, serif;
	font-size: 12pt;
  }
  .title { text-align: center; }
  .todo  { color: red; }
  .done { color: green; }
  .timestamp { color: grey }
  .timestamp-kwd { color: CadetBlue }
  .tag { background-color:lightblue; font-weight:normal }
  .target { background-color: lavender; }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
  }
  table { border-collapse: collapse; }
  td, th {
	vertical-align: top;
	<!--border: 1pt solid #ADB9CC;-->
  }
</style>
</head><body>
<h1 class="title">TODO-asep</h1>
<h2>Table of Contents</h2>
<ul>
<li><a href="#sec-1">1 ui still to do</a>
<ul>
<li><a href="#sec-2">1.1 company checks</a>
<ul>
<li><a href="#sec-3">1.1.1 look at her spreadsheet to see</a></li>
<li><a href="#sec-4">1.1.2 show check # date, and scholarship (they have to see it)</a></li>
<li><a href="#sec-5">1.1.3 an undelivered checks screen, by class</a></li>
<li><a href="#sec-6">1.1.4 a joint as example: [[http://localhost/asepgui/index.php/Company/2][http://localhost/asepgui/index.php/Company/2]]</a></li>
<li><a href="#sec-7">1.1.5 a printout of it for the company, or let them log in to see</a></li>
</ul>
</li>
<li><a href="#sec-8">1.2 joint checks show unpaid vs paid classes as a separate group in dropdown</a></li>
</ul>
</li>
<li><a href="#sec-9">2 must have for NEXT SESSION!</a>
<ul>
<li><a href="#sec-10">2.1 add db field for registration start date/time for session</a>
<ul>
<li><a href="#sec-11">2.1.1 and dynamically show that on index/home page!</a></li>
</ul>
</li>
<li><a href="#sec-12">2.2 add db field for public or not (sessions)!</a>
<ul>
<li><a href="#sec-13">2.2.1 so admin can have sessions not yet publicly visible</a></li>
</ul>
</li>
<li><a href="#sec-14">2.3 put in proper RBAC</a>
<ul>
<li><a href="#sec-15">2.3.1 instructors passwords</a></li>
<li><a href="#sec-16">2.3.2 a proper guest role too</a></li>
<li><a href="#sec-17">2.3.3 and multiple admin accounts</a></li>
<li><a href="#sec-18">2.3.4 change all the -&gt;user to -&gt;role everywhere</a></li>
<li><a href="#sec-19">2.3.5 this needs to happen BEFORE i get to the choosing of the schoolyear</a></li>
</ul>
</li>
<li><a href="#sec-20">2.4 redesign the homepage setup</a>
<ul>
<li><a href="#sec-21">2.4.1 dispatch to different home pages based on role!</a></li>
<li><a href="#sec-22">2.4.2 a strategy for custom homepages, use a controller for the logic</a></li>
</ul>
</li>
<li><a href="#sec-23">2.5 for setting session, for now, just a simple non-ajax screen, nothing fancy</a>
<ul>
<li><a href="#sec-24">2.5.1 this will have to be permission-enabled!</a></li>
</ul>
</li>
<li><a href="#sec-25">2.6 go through and make sure all my queries and searches are session-enabled</a>
<ul>
<li><a href="#sec-26">2.6.1 the big issue will be all the dropdowns, which use findAll()</a></li>
<li><a href="#sec-27">2.6.2 did i do this already?</a></li>
</ul>
</li>
<li><a href="#sec-28">2.7 how to import/add new class from previous session</a>
<ul>
<li><a href="#sec-29">2.7.1 an ajaxything or something, a popup</a></li>
<li><a href="#sec-30">2.7.2 relational deep copy! only a few tables though:</a></li>
</ul>
</li>
<li><a href="#sec-31">2.8 delete a class</a></li>
<li><a href="#sec-32">2.9 requirements per class, i.e. for agreement</a>
<ul>
<li><a href="#sec-33">2.9.1 remove unique key constraint</a></li>
<li><a href="#sec-34">2.9.2 checkbox for requirement per class</a></li>
<li><a href="#sec-35">2.9.3 fk to class id</a></li>
<li><a href="#sec-36">2.9.4 hide fk if checkbox not checed</a></li>
<li><a href="#sec-37">2.9.5 in report check each class if checkbox chcked.</a></li>
<li><a href="#sec-38">2.9.6 in status, i'll need MAX() queries instead of AR stuff</a></li>
<li><a href="#sec-39">2.9.7 allow multiple requirements, i.e contracts for several years</a></li>
</ul>
</li>
<li><a href="#sec-40">2.10 the signup form and week/month schedule</a>
<ul>
<li><a href="#sec-41">2.10.1 add fields for the TEXT of the form!</a></li>
<li><a href="#sec-42">2.10.2 this will probably require tcpdf (see elsewhere)</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-43">3 vital</a>
<ul>
<li><a href="#sec-44">3.1 use ajax tabs!</a>
<ul>
<li><a href="#sec-45">3.1.1 it's possible! just need to do what i did for income, use true,false for renderpartial</a></li>
<li><a href="#sec-46">3.1.2 and, i need to make the edit links use createurl explicitly</a></li>
<li><a href="#sec-47">3.1.3 it totally breaks my auto-enter stuff in deposits though!</a></li>
<li><a href="#sec-48">3.1.4 delete links don't work though. why?</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-49">4 useful</a>
<ul>
<li><a href="#sec-50">4.1 backup refinements</a>
<ul>
<li><a href="#sec-51">4.1.1 somehow protect that cgi a bit better</a></li>
<li><a href="#sec-52">4.1.2 make sure backup integrity is ok</a></li>
<li><a href="#sec-53">4.1.3 and show it as backup status, somewhere, like on admin page</a></li>
</ul>
</li>
<li><a href="#sec-54">4.2 cgridview pager fix</a>
<ul>
<li><a href="#sec-55">4.2.1 somehow force KArrayDataProvider to use no pagination as default?</a></li>
<li><a href="#sec-56">4.2.2 leave cgridview pager 10 but provide an ajax button to show all (no pager)</a></li>
</ul>
</li>
<li><a href="#sec-57">4.3 in _income, make amount autopopulate ajax based on class chosen</a>
<ul>
<li><a href="#sec-58">4.3.1 autocomplete the amount on income based on class</a></li>
</ul>
</li>
<li><a href="#sec-59">4.4 make all the -&gt;dropDown stuff have an array('empty' =&gt; 'Choose One') in options</a></li>
<li><a href="#sec-60">4.5 a student signup screen</a>
<ul>
<li><a href="#sec-61">4.5.1 [[http://www.yiiframework.com/wiki/72/cjuidialog-and-ajaxsubmitbutton/][http://www.yiiframework.com/wiki/72/cjuidialog-and-ajaxsubmitbutton/]]</a></li>
<li><a href="#sec-62">4.5.2 easier [[http://www.yiiframework.com/wiki/145/cjuidialog-for-create-new-model/][http://www.yiiframework.com/wiki/145/cjuidialog-for-create-new-model/]]</a></li>
</ul>
</li>
<li><a href="#sec-63">4.6 go through all the multi-link _forms, put &lt;div row&gt; before the issset</a></li>
<li><a href="#sec-64">4.7 redo the unpaid thing, this is ridiculous</a></li>
<li><a href="#sec-65">4.8 make session dropdown disabled css by default, checkbox to change</a></li>
<li><a href="#sec-66">4.9 validation and data entry error checking/warning</a>
<ul>
<li><a href="#sec-67">4.9.1 ajax validation via yii built in -- errors</a></li>
<li><a href="#sec-68">4.9.2 trapping sql/fk errors through ajax validation</a></li>
<li><a href="#sec-69">4.9.3 js validation via yii built in</a></li>
<li><a href="#sec-70">4.9.4 ajax validation via yii built in -- warnings/notice</a></li>
<li><a href="#sec-71">4.9.5 not sure where</a></li>
<li><a href="#sec-72">4.9.6 how?</a></li>
</ul>
</li>
<li><a href="#sec-73">4.10 date formatting and saving cleanups</a>
<ul>
<li><a href="#sec-74">4.10.1 manually edit dates, in m/d/y format</a></li>
<li><a href="#sec-75">4.10.2 clean up date and weekday formatting, using formatter in yii</a></li>
<li><a href="#sec-76">4.10.3 add date validator</a></li>
<li><a href="#sec-77">4.10.4 make date pickers have longer terms for some things (meetings, paperwork)</a></li>
<li><a href="#sec-78">4.10.5 year bump buttons on the expired and received datepickers</a></li>
<li><a href="#sec-79">4.10.6 dependent date/timepickers, i.e. start/end intelligently</a></li>
</ul>
</li>
<li><a href="#sec-80">4.11 remove search/sort for nonsortable columns</a></li>
<li><a href="#sec-81">4.12 add  the returnto for zhtml::clickablerow</a></li>
<li><a href="#sec-82">4.13 today button, fix</a></li>
<li><a href="#sec-83">4.14 let instructors edit descriptions</a>
<ul>
<li><a href="#sec-84">4.14.1 this will require maybe another flag to disable that, from admin</a></li>
</ul>
</li>
<li><a href="#sec-85">4.15 admin simulation of instructor screens</a>
<ul>
<li><a href="#sec-86">4.15.1 a chooser for instructor at the top.</a></li>
</ul>
</li>
<li><a href="#sec-87">4.16 trap exceptions on save,  if there's an integrity constraint!</a></li>
<li><a href="#sec-88">4.17 use either breadcrumbs or returnto, but be consistent!</a></li>
<li><a href="#sec-89">4.18 make the ajax/json checkincomecontroller payer save use massive assignemnt with safe</a></li>
<li><a href="#sec-90">4.19 also trap exceptions on double-delete, it happens in ajax-land</a></li>
<li><a href="#sec-91">4.20 search/sort</a>
<ul>
<li><a href="#sec-92">4.20.1 make search work with booleans/checkboxes</a></li>
<li><a href="#sec-93">4.20.2 make search work with linktables!</a></li>
<li><a href="#sec-94">4.20.3 make sort work with linked subviews</a></li>
<li><a href="#sec-95">4.20.4 clean up massive sql queries and translate them into cdbcriteria</a></li>
</ul>
</li>
<li><a href="#sec-96">4.21 browser exploiter crap</a>
<ul>
<li><a href="#sec-97">4.21.1 backspace makes the page go back, no warning, in IE</a></li>
<li><a href="#sec-98">4.21.2 chosen hitting return gives a warning that page leaving in IE</a></li>
</ul>
</li>
<li><a href="#sec-99">4.22 multiline entry for checks</a>
<ul>
<li><a href="#sec-100">4.22.1 make multi-entry form work for EDITING too</a></li>
<li><a href="#sec-101">4.22.2 multi-form: should auto-javascript calculate totals applied and check them</a></li>
</ul>
</li>
<li><a href="#sec-102">4.23 move the code for student #x of max y from javascript to a php or js lib function</a></li>
<li><a href="#sec-103">4.24 more the check waitlist function on signup/multientry from that stupid $('select') to just a function in _row</a></li>
<li><a href="#sec-104">4.25 this returnurl GET param crap is broken. the right yii-ish way is to use getreturnurl/setreturnurl in SESSION</a></li>
<li><a href="#sec-105">4.26 signups: add cancelled date and hide/clear it on non cancelled</a></li>
<li><a href="#sec-106">4.27 make company id 1  not editable or removable (company form/view)</a></li>
<li><a href="#sec-107">4.28 autocompletes not dropdowns</a>
<ul>
<li><a href="#sec-108">4.28.1 students</a></li>
<li><a href="#sec-109">4.28.2 classes</a></li>
<li><a href="#sec-110">4.28.3 roster import</a></li>
</ul>
</li>
<li><a href="#sec-111">4.29 trap exception on populate for school days</a></li>
<li><a href="#sec-112">4.30 make the deposit form editable in the same format as the printabel one</a></li>
<li><a href="#sec-113">4.31 to avoid confusion, special case the company stuff with js</a>
<ul>
<li><a href="#sec-114">4.31.1 if company is not PTO, or is type company, show delivered, not deposited</a></li>
<li><a href="#sec-115">4.31.2 if instructor type is company, show the company popup</a></li>
<li><a href="#sec-116">4.31.3 if is not company, don't show company popup at all</a></li>
<li><a href="#sec-117">4.31.4 javascript in forms, something else in view</a></li>
</ul>
</li>
<li><a href="#sec-118">4.32 new on pulldowns!! so new instructor at end of pulldown for instructor</a></li>
<li><a href="#sec-119">4.33 now make the save() actions check breadcrumbs, not returnto</a></li>
<li><a href="#sec-120">4.34 instructors need to use both email addresses to login if they have &gt; 1</a></li>
</ul>
</li>
<li><a href="#sec-121">5 cosmetic</a>
<ul>
<li><a href="#sec-122">5.1 put in $this-&gt;pageTitle= for all the pages! helps with breadcrumbs</a></li>
<li><a href="#sec-123">5.2 use the roster as the template for any index views, i have the css nice</a></li>
<li><a href="#sec-124">5.3 the chosen fields are too narrow</a></li>
<li><a href="#sec-125">5.4 the spans i'm using should be DIVS! everywhere (almost)!</a></li>
<li><a href="#sec-126">5.5 remove all those style: alignt-right things and make it proper css!</a></li>
<li><a href="#sec-127">5.6 in general, make menu on views like checkincome (just edit and delete)</a></li>
<li><a href="#sec-128">5.7 a nice jui popup when hovering over a cell, showing description!</a></li>
<li><a href="#sec-129">5.8 use wide layout with menu at top from roster for ALL things</a></li>
<li><a href="#sec-130">5.9 the goddamned times are wrong, they're not in am/pm time! they don't convert</a></li>
<li><a href="#sec-131">5.10 generate via pdf</a>
<ul>
<li><a href="#sec-132">5.10.1 what</a></li>
<li><a href="#sec-133">5.10.2 how</a></li>
</ul>
</li>
<li><a href="#sec-134">5.11 make all monetary fields NOT NULL default 0!</a>
<ul>
<li><a href="#sec-135">5.11.1 be careful though, it might break stuff. i.e. the model, required validation</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-136">6 bugfixen</a>
<ul>
<li><a href="#sec-137">6.1 in paid, why are cancelleds payments not showing up at all?</a></li>
<li><a href="#sec-138">6.2 they WERE paid. only returned checks shouldn't show up.</a></li>
<li><a href="#sec-139">6.3 chozen does not like being provided with arrays from sql finds</a>
<ul>
<li><a href="#sec-140">6.3.1 it sends the right stuff, but no search is actually occurring</a></li>
</ul>
</li>
<li><a href="#sec-141">6.4 oh crap. how to deal with partial refunds???</a></li>
</ul>
</li>
<li><a href="#sec-142">7 must have for NEXT YEAR:</a>
<ul>
<li><a href="#sec-143">7.1 need some way to track the current school year.</a>
<ul>
<li><a href="#sec-144">7.1.1 yes, i remember now!!!! it took today's date, calculated month!</a></li>
</ul>
</li>
<li><a href="#sec-145">7.2 picklist of STUDENTS could get huge, and need to be pared down</a>
<ul>
<li><a href="#sec-146">7.2.1 how to determine when kids are no longer in ocean shore??</a></li>
<li><a href="#sec-147">7.2.2 um, graduate them? when updating grades, if grade &gt; 8, remove</a></li>
<li><a href="#sec-148">7.2.3 also, grade needs to be updated every year somehow</a></li>
<li><a href="#sec-149">7.2.4 current flag?</a></li>
</ul>
</li>
<li><a href="#sec-150">7.3 i will DEFINITELY need some kind of de-duping system</a>
<ul>
<li><a href="#sec-151">7.3.1 like i had to do for the coop. it'll have to happen.</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-152">8 STUCK</a>
<ul>
<li><a href="#sec-153">8.1 student parentt relaton for user signin</a>
<ul>
<li><a href="#sec-154">8.1.1 so a parent would be a user, and it would have to be tied to some # of students</a></li>
<li><a href="#sec-155">8.1.2 that is REALLY HARD, how do you map them conceptually?</a></li>
</ul>
</li>
<li><a href="#sec-156">8.2 open questions</a>
<ul>
<li><a href="#sec-157">8.2.1 how do you know who to write the check to (from that report)?</a></li>
<li><a href="#sec-158">8.2.2 will you have a case where the materials fee is NOT PER CLASS</a></li>
</ul>
</li>
<li><a href="#sec-159">8.3 student payment status, i.e. enrollment with payment status</a></li>
<li><a href="#sec-160">8.4 ok, forms starting to make sense</a></li>
</ul>
</li>
<li><a href="#sec-161">9 FOR NON-ADMIN USER LOGIN</a></li>
<li><a href="#sec-162">10 BELOW THE LINE</a>
<ul>
<li><a href="#sec-163">10.1 maybe make location a link column, not let them be in same place</a></li>
<li><a href="#sec-164">10.2 try editable datatable!</a></li>
<li><a href="#sec-165">10.3 expenses really do need to be assigned to classes (but not students)</a></li>
<li><a href="#sec-166">10.4 have a checkbox on income page to select which classes to pay</a></li>
<li><a href="#sec-167">10.5 visual show/add meeting dates</a></li>
<li><a href="#sec-168">10.6 new student wizard really. ajaxy: class-&gt;student-&gt;import-&gt;signup</a></li>
<li><a href="#sec-169">10.7 finish the relational mappings</a>
<ul>
<li><a href="#sec-170">10.7.1 a way to create/edit/save a dependent model with ONE field in relation</a></li>
<li><a href="#sec-171">10.7.2 gui splits for income/expense</a></li>
</ul>
</li>
<li><a href="#sec-172">10.8 autoppopulate the check when adding</a></li>
<li><a href="#sec-173">10.9 how to handle teachers who are students?</a></li>
</ul>
</li>
<li><a href="#sec-174">11 open questions</a></li>
</ul>

<h2><a name="sec-1">1 ui still to do</a></h2>


<h3><a name="sec-2">1.1 company checks</a></h3>


<h4><a name="sec-3">1.1.1 look at her spreadsheet to see</a></h4>


<h4><a name="sec-4">1.1.2 show check # date, and scholarship (they have to see it)</a></h4>


<h4><a name="sec-5">1.1.3 an undelivered checks screen, by class</a></h4>

<p>just checkboxes, and a date, and mark delivered for all of them.
pick which checks are delivered!
they are by class, which is how she files them
classinfo/_income
a checkbox, mark all, save, would be fine
</p>
<h4><a name="sec-6">1.1.4 a joint as example: <a href="http://localhost/asepgui/index.php/Company/2">http://localhost/asepgui/index.php/Company/2</a></a></h4>


<h4><a name="sec-7">1.1.5 a printout of it for the company, or let them log in to see</a></h4>


<h3><a name="sec-8">1.2 joint checks show unpaid vs paid classes as a separate group in dropdown</a></h3>


<h2><a name="sec-9">2 must have for NEXT SESSION!</a></h2>


<h3><a name="sec-10">2.1 add db field for registration start date/time for session</a></h3>


<h4><a name="sec-11">2.1.1 and dynamically show that on index/home page!</a></h4>


<h3><a name="sec-12">2.2 add db field for public or not (sessions)!</a></h3>


<h4><a name="sec-13">2.2.1 so admin can have sessions not yet publicly visible</a></h4>


<h3><a name="sec-14">2.3 put in proper RBAC</a></h3>


<h4><a name="sec-15">2.3.1 instructors passwords</a></h4>

<ul>
<li>a table with<br/>
id
password
fk id
fk table (i.e. instructor, parent, company, etc)
<ul>
<li>how to handle non-parents, non-instructors?<br/>
maybe another table of just plain old users? ugly, but it'd work.
yep, with username, i.e. office, parent?
really only parent, since office can be patricia's email
</li>
</ul></li>
<li>a screen to let them change their password<br/>
</li>
<li>a filter to force them to change it<br/>
<a href="http://www.yiiframework.com/wiki/237/force-a-user-to-change-their-password-changepasswordfilter/">http://www.yiiframework.com/wiki/237/force-a-user-to-change-their-password-changepasswordfilter/</a>

</li>
</ul>
<h4><a name="sec-16">2.3.2 a proper guest role too</a></h4>


<h4><a name="sec-17">2.3.3 and multiple admin accounts</a></h4>


<h4><a name="sec-18">2.3.4 change all the -&gt;user to -&gt;role everywhere</a></h4>


<h4><a name="sec-19">2.3.5 this needs to happen BEFORE i get to the choosing of the schoolyear</a></h4>

<ul>
<li>because the schoolyearchooser needs to be constrained by user role<br/>
</li>
<li>only admins can change to unpublished classsessions<br/>
</li>
<li>well, no, instructors can see them too, if it's THEIR class<br/>
just the listing of this can get wild and hairy, i.e. homepage
</li>
</ul>
<h3><a name="sec-20">2.4 redesign the homepage setup</a></h3>


<h4><a name="sec-21">2.4.1 dispatch to different home pages based on role!</a></h4>

<ul>
<li>right now it looks like sitecontroller/index does that<br/>
</li>
<li>there's code in the office one that belongs in controller<br/>
</li>
</ul>
<h4><a name="sec-22">2.4.2 a strategy for custom homepages, use a controller for the logic</a></h4>

<ul>
<li>some kind of dispatch method, which homepage for which user<br/>
</li>
<li>what gets shown on what (maybe use roles?)<br/>
</li>
</ul>
<h3><a name="sec-23">2.5 for setting session, for now, just a simple non-ajax screen, nothing fancy</a></h3>

<p>then i have to start using it in queries. named scope, seems right.
</p>
<h4><a name="sec-24">2.5.1 this will have to be permission-enabled!</a></h4>

<p>only admin can pick sessions that are not yet public
</p>
<h3><a name="sec-25">2.6 go through and make sure all my queries and searches are session-enabled</a></h3>

<p>so i can change them later easily
this means the popups too.
default sort/scope for everytbing
search and such
</p>
<h4><a name="sec-26">2.6.1 the big issue will be all the dropdowns, which use findAll()</a></h4>

<p>i should start constraining those by session!
use named scope, it's easy, default scope is session now!
searches also, need to use the named scope or something
</p>
<h4><a name="sec-27">2.6.2 did i do this already?</a></h4>


<h3><a name="sec-28">2.7 how to import/add new class from previous session</a></h3>


<h4><a name="sec-29">2.7.1 an ajaxything or something, a popup</a></h4>


<h4><a name="sec-30">2.7.2 relational deep copy! only a few tables though:</a></h4>

<ul>
<li>instructors, it'll need to create new joins for them. just them!<br/>
</li>
<li>extra fees<br/>
</li>
<li>not students though. until parents sign them up! or income.<br/>
</li>
</ul>
<h3><a name="sec-31">2.8 delete a class</a></h3>

<p>first fix the link, it's not a-werken (missing js?)
only delete class is no students signed up
do not let them delete otherwise
DO automatically delete all the dates and instructors
delete from instructor_assignment where class_id=:cid
delete from class_meeting where class_id=:cid
delete from class_info where id=:cid
</p>
<h3><a name="sec-32">2.9 requirements per class, i.e. for agreement</a></h3>


<h4><a name="sec-33">2.9.1 remove unique key constraint</a></h4>


<h4><a name="sec-34">2.9.2 checkbox for requirement per class</a></h4>


<h4><a name="sec-35">2.9.3 fk to class id</a></h4>


<h4><a name="sec-36">2.9.4 hide fk if checkbox not checed</a></h4>


<h4><a name="sec-37">2.9.5 in report check each class if checkbox chcked.</a></h4>


<h4><a name="sec-38">2.9.6 in status, i'll need MAX() queries instead of AR stuff</a></h4>


<h4><a name="sec-39">2.9.7 allow multiple requirements, i.e contracts for several years</a></h4>


<h3><a name="sec-40">2.10 the signup form and week/month schedule</a></h3>


<h4><a name="sec-41">2.10.1 add fields for the TEXT of the form!</a></h4>

<p>so that heidi can edit it
</p>
<h4><a name="sec-42">2.10.2 this will probably require tcpdf (see elsewhere)</a></h4>


<h2><a name="sec-43">3 vital</a></h2>


<h3><a name="sec-44">3.1 use ajax tabs!</a></h3>


<h4><a name="sec-45">3.1.1 it's possible! just need to do what i did for income, use true,false for renderpartial</a></h4>


<h4><a name="sec-46">3.1.2 and, i need to make the edit links use createurl explicitly</a></h4>


<h4><a name="sec-47">3.1.3 it totally breaks my auto-enter stuff in deposits though!</a></h4>

<ul>
<li>on the checks page, it makes it submit the deleteall link for the CASH page? WTF??!<br/>
</li>
</ul>
<h4><a name="sec-48">3.1.4 delete links don't work though. why?</a></h4>


<h2><a name="sec-49">4 useful</a></h2>


<h3><a name="sec-50">4.1 backup refinements</a></h3>


<h4><a name="sec-51">4.1.1 somehow protect that cgi a bit better</a></h4>

<ul>
<li>make that directory scriptaliased?<br/>
</li>
<li>move it to protected and make the cgi work there?<br/>
</li>
<li>pass in passwords, etc, rather than having it hardcoded in the cgi?<br/>
</li>
</ul>
<h4><a name="sec-52">4.1.2 make sure backup integrity is ok</a></h4>

<p>run bunzip2 -t, a test decompression, after the backup
</p>
<h4><a name="sec-53">4.1.3 and show it as backup status, somewhere, like on admin page</a></h4>

<ul>
<li>that's mean a db table saving date/ip of last backup<br/>
<ul>
<li>datetime<br/>
</li>
<li>ipaddress<br/>
</li>
<li>username (can have multiple)<br/>
</li>
</ul></li>
</ul>
<h3><a name="sec-54">4.2 cgridview pager fix</a></h3>


<h4><a name="sec-55">4.2.1 somehow force KArrayDataProvider to use no pagination as default?</a></h4>


<h4><a name="sec-56">4.2.2 leave cgridview pager 10 but provide an ajax button to show all (no pager)</a></h4>

<ul>
<li>especially in checks<br/>
</li>
<li>there's pagination in karraydataprovider, also cpagination<br/>
<ul>
<li>but how? init doesn't work, __construct doesn't work. wtf?<br/>
</li>
</ul></li>
<li>also this: <a href="http://www.yiiframework.com/forum/index.php?/topic/27742-where-to-set-default-pagesize/">http://www.yiiframework.com/forum/index.php?/topic/27742-where-to-set-default-pagesize/</a><br/>
<ul>
<li>Edit CPagination (Yuck!)<br/>
</li>
<li>Extend CPagination and have your version pull the data out of config.<br/>
<ul>
<li>like this:  <a href="http://www.yiiframework.com/extension/pagesize/">http://www.yiiframework.com/extension/pagesize/</a><br/>
<ul>
<li>NOTE requires yii 1.1.8, which i think i have<br/>
</li>
</ul></li>
</ul></li>
<li>Then set it as the pagination object for CActiveDataProvider with the setPagination() method.<br/>
You could even extend CActiveDataProvider so it used your Pagination class as it's default Pagination object.
</li>
</ul></li>
</ul>
<h3><a name="sec-57">4.3 in _income, make amount autopopulate ajax based on class chosen</a></h3>


<h4><a name="sec-58">4.3.1 autocomplete the amount on income based on class</a></h4>

<p>didn't i do that already?
$("#form_field").chosen().change( … );
didn't i do that already?
</p>
<h3><a name="sec-59">4.4 make all the -&gt;dropDown stuff have an array('empty' =&gt; 'Choose One') in options</a></h3>


<h3><a name="sec-60">4.5 a student signup screen</a></h3>

<p>just a student pulldown, a few tabs, etc
</p>
<h4><a name="sec-61">4.5.1 <a href="http://www.yiiframework.com/wiki/72/cjuidialog-and-ajaxsubmitbutton/">http://www.yiiframework.com/wiki/72/cjuidialog-and-ajaxsubmitbutton/</a></a></h4>


<h4><a name="sec-62">4.5.2 easier <a href="http://www.yiiframework.com/wiki/145/cjuidialog-for-create-new-model/">http://www.yiiframework.com/wiki/145/cjuidialog-for-create-new-model/</a></a></h4>


<h3><a name="sec-63">4.6 go through all the multi-link _forms, put &lt;div row&gt; before the issset</a></h3>

<p>WHY? exactly?
</p>
<h3><a name="sec-64">4.7 redo the unpaid thing, this is ridiculous</a></h3>

<p>do this stupidity in sql
class
cost - income.amount for this student and class
where this student,
and the cost - paid is &gt; 0!
sort by payee
link for new check, or assign existing check (unassigned)
choose existing check as option in unpaid
an autocomplete with lists of checks with amounts still avail on them
</p>
<h3><a name="sec-65">4.8 make session dropdown disabled css by default, checkbox to change</a></h3>

<p>in almost every screen. session should always be default really
</p>
<h3><a name="sec-66">4.9 validation and data entry error checking/warning</a></h3>


<h4><a name="sec-67">4.9.1 ajax validation via yii built in -- errors</a></h4>

<ul>
<li>don't allow returned checks to be deposited/delivered!<br/>
</li>
<li>don't allow deposited/delivered checks to be returned!<br/>
</li>
<li>[#A] the student must be signed up for that class before it gets paid<br/>
look up the keys, see that there's something there
i can use my duplicate validator as a guide
but! better to constrain isn't it?
</li>
<li>[#B] a check or split where totals exceed check<br/>
make sure the incomes are not more or less than the total check
it's probably ok if the incomes are LESS than total check tho
</li>
<li>instructor percentages don't exceed 100%<br/>
<ul>
<li>make a validation rule to make sure that the instructors aren't getting &gt; 100 % !!<br/>
i.e. check to see if a class has &gt; 100% total

<p>
in the some popup (chosen?), the # is breaking stuff
i decided not to use it, so this is below the line for now
</p>

</li>
</ul></li>
</ul>
<h4><a name="sec-68">4.9.2 trapping sql/fk errors through ajax validation</a></h4>

<ul>
<li>trying to delete things that have foreign keys<br/>
in check, for sure, but also everywhere really
</li>
<li>change company name with instructors who are not in that company<br/>
this is an easy one, really. in fact i could do it as JS or ajax
</li>
<li>duplicate key, unique validators, dupe checking! for all records really<br/>
all the linktables! it'll have to check key combos
first/last in student
class meeting/class_id unique
school day in calendar
</li>
</ul>
<h4><a name="sec-69">4.9.3 js validation via yii built in</a></h4>

<ul>
<li>entering to a session not the current default<br/>
</li>
</ul>
<h4><a name="sec-70">4.9.4 ajax validation via yii built in -- warnings/notice</a></h4>

<ul>
<li>class over capacity but student set to enrolled<br/>
i could really do that just as a status bar in the controller/view
</li>
<li>change the day of week but there are active meetings<br/>
</li>
</ul>
<h4><a name="sec-71">4.9.5 not sure where</a></h4>


<h4><a name="sec-72">4.9.6 how?</a></h4>

<p>populate a js array with the data, and check it that way?
</p>
<h3><a name="sec-73">4.10 date formatting and saving cleanups</a></h3>


<h4><a name="sec-74">4.10.1 manually edit dates, in m/d/y format</a></h4>


<h4><a name="sec-75">4.10.2 clean up date and weekday formatting, using formatter in yii</a></h4>

<ul>
<li>not my zhtml hack<br/>
</li>
<li>date/time conversions<br/>
<ul>
<li>do it in the load_model method!<br/>
</li>
<li>and before save in update/create.<br/>
</li>
<li>that is all. no problems, no muss, no fuss.<br/>
</li>
</ul></li>
<li>but beware the afterfind/beforevalidate crap!<br/>
<ul>
<li>it could break my model start/end stuff VERY IMPORTANT!<br/>
</li>
<li>do it by overloading load_model and beforevalidate, instead<br/>
</li>
<li>BE CAREFUL!<br/>
</li>
</ul></li>
<li>i could create a separate get/set that wraps it<br/>
<ul>
<li>for every model that has dates in it. gah.<br/>
</li>
<li>or a wrapper that transforms them before/after manually<br/>
</li>
</ul></li>
</ul>
<h4><a name="sec-76">4.10.3 add date validator</a></h4>


<h4><a name="sec-77">4.10.4 make date pickers have longer terms for some things (meetings, paperwork)</a></h4>


<h4><a name="sec-78">4.10.5 year bump buttons on the expired and received datepickers</a></h4>

<ul>
<li>didn't i do that already?<br/>
</li>
</ul>
<h4><a name="sec-79">4.10.6 dependent date/timepickers, i.e. start/end intelligently</a></h4>


<h3><a name="sec-80">4.11 remove search/sort for nonsortable columns</a></h3>

<p>set filter =&gt; false
</p>
<h3><a name="sec-81">4.12 add  the returnto for zhtml::clickablerow</a></h3>

<p>it's already in there for composite keys, but i need to add it for the other one
this is used only in a few places though.
</p>
<h3><a name="sec-82">4.13 today button, fix</a></h3>


<h3><a name="sec-83">4.14 let instructors edit descriptions</a></h3>


<h4><a name="sec-84">4.14.1 this will require maybe another flag to disable that, from admin</a></h4>


<h3><a name="sec-85">4.15 admin simulation of instructor screens</a></h3>


<h4><a name="sec-86">4.15.1 a chooser for instructor at the top.</a></h4>

<ul>
<li>just an echosen probably, with an autosubmit or ajax<br/>
</li>
</ul>
<h3><a name="sec-87">4.16 trap exceptions on save,  if there's an integrity constraint!</a></h3>

<p>trap/catch errors when trying to delete linked tables
hmm, when woudl that exactly happen again?
</p>
<h3><a name="sec-88">4.17 use either breadcrumbs or returnto, but be consistent!</a></h3>

<p>breadcrumbs is cleaner than returnto, but will it work?
</p>
<h3><a name="sec-89">4.18 make the ajax/json checkincomecontroller payer save use massive assignemnt with safe</a></h3>

<p>right now it's just a hack, $model-&gt;bar = $_POST[foo][bar]
</p>
<h3><a name="sec-90">4.19 also trap exceptions on double-delete, it happens in ajax-land</a></h3>

<p>if the refresh isn't complete yet
Error 404: &lt;h1&gt;CHttpException
The requested page does not exist.
it really is an error, you can't delete something that is already deleted
</p>
<h3><a name="sec-91">4.20 search/sort</a></h3>


<h4><a name="sec-92">4.20.1 make search work with booleans/checkboxes</a></h4>


<h4><a name="sec-93">4.20.2 make search work with linktables!</a></h4>

<p>this i think will be some interesting criteria and joins perhaps
maybe not that hard, just some pdo stuff
<a href="http://www.mrsoundless.com/post/2011/05/09/Searching-and-sorting-a-column-from-a-related-table-in-a-CGridView.aspx">http://www.mrsoundless.com/post/2011/05/09/Searching-and-sorting-a-column-from-a-related-table-in-a-CGridView.aspx</a>
</p>
<h4><a name="sec-94">4.20.3 make sort work with linked subviews</a></h4>

<p>not so easy
</p>
<h4><a name="sec-95">4.20.4 clean up massive sql queries and translate them into cdbcriteria</a></h4>

<p>so i can have searches and sorts, also sums and totals!
</p>
<h3><a name="sec-96">4.21 browser exploiter crap</a></h3>


<h4><a name="sec-97">4.21.1 backspace makes the page go back, no warning, in IE</a></h4>


<h4><a name="sec-98">4.21.2 chosen hitting return gives a warning that page leaving in IE</a></h4>

<p>ah, becuase it has input fields not enclosed in form tags, that's why!
</p>

<h3><a name="sec-99">4.22 multiline entry for checks</a></h3>


<h4><a name="sec-100">4.22.1 make multi-entry form work for EDITING too</a></h4>

<p>now the saving
create, student id provided
create, nothing provided
</p>
<h4><a name="sec-101">4.22.2 multi-form: should auto-javascript calculate totals applied and check them</a></h4>


<h3><a name="sec-102">4.23 move the code for student #x of max y from javascript to a php or js lib function</a></h3>

<p>it's used in signup/_form and signup/_row, and it's slightly different
</p>
<h3><a name="sec-103">4.24 more the check waitlist function on signup/multientry from that stupid $('select') to just a function in _row</a></h3>


<h3><a name="sec-104">4.25 this returnurl GET param crap is broken. the right yii-ish way is to use getreturnurl/setreturnurl in SESSION</a></h3>


<h3><a name="sec-105">4.26 signups: add cancelled date and hide/clear it on non cancelled</a></h3>


<h3><a name="sec-106">4.27 make company id 1  not editable or removable (company form/view)</a></h3>


<h3><a name="sec-107">4.28 autocompletes not dropdowns</a></h3>


<h4><a name="sec-108">4.28.1 students</a></h4>


<h4><a name="sec-109">4.28.2 classes</a></h4>


<h4><a name="sec-110">4.28.3 roster import</a></h4>


<h3><a name="sec-111">4.29 trap exception on populate for school days</a></h3>


<h3><a name="sec-112">4.30 make the deposit form editable in the same format as the printabel one</a></h3>

<p>in other words, make the "printable" report into a form, with edit
i'm pretty much halfway there with the payee enter, the coin form, and the add/undeposit javascript
</p>
<h3><a name="sec-113">4.31 to avoid confusion, special case the company stuff with js</a></h3>


<h4><a name="sec-114">4.31.1 if company is not PTO, or is type company, show delivered, not deposited</a></h4>

<ul>
<li>else  show deposited, not delivered<br/>
</li>
</ul>
<h4><a name="sec-115">4.31.2 if instructor type is company, show the company popup</a></h4>

<ul>
<li>else hide company popup<br/>
</li>
</ul>
<h4><a name="sec-116">4.31.3 if is not company, don't show company popup at all</a></h4>


<h4><a name="sec-117">4.31.4 javascript in forms, something else in view</a></h4>


<h3><a name="sec-118">4.32 new on pulldowns!! so new instructor at end of pulldown for instructor</a></h3>


<h3><a name="sec-119">4.33 now make the save() actions check breadcrumbs, not returnto</a></h3>


<h3><a name="sec-120">4.34 instructors need to use both email addresses to login if they have &gt; 1</a></h3>


<h2><a name="sec-121">5 cosmetic</a></h2>


<h3><a name="sec-122">5.1 put in $this-&gt;pageTitle= for all the pages! helps with breadcrumbs</a></h3>


<h3><a name="sec-123">5.2 use the roster as the template for any index views, i have the css nice</a></h3>


<h3><a name="sec-124">5.3 the chosen fields are too narrow</a></h3>

<p>there's a width set, but it's wrong
this.f_width = this.form_field_jq.width();
</p>
<h3><a name="sec-125">5.4 the spans i'm using should be DIVS! everywhere (almost)!</a></h3>

<p>just because it's called span-xx does NOT MEAN THEY ARE FOR SPANS
they're actually for divs, not spans, doh!
</p>
<h3><a name="sec-126">5.5 remove all those style: alignt-right things and make it proper css!</a></h3>

<p>it didn't work last i tried it though, there was some css selector problem
</p>
<h3><a name="sec-127">5.6 in general, make menu on views like checkincome (just edit and delete)</a></h3>

<p>and maybe add ones for the others, the tab ones
</p>
<h3><a name="sec-128">5.7 a nice jui popup when hovering over a cell, showing description!</a></h3>


<h3><a name="sec-129">5.8 use wide layout with menu at top from roster for ALL things</a></h3>

<p>it needs to be integrated into class for sure, and student
this is in roster, in main branch
i also have it in a branch menuthrash. works with clips, nice!
</p>
<h3><a name="sec-130">5.9 the goddamned times are wrong, they're not in am/pm time! they don't convert</a></h3>

<p>this is the timepicker brokenness, fix it
</p>
<h3><a name="sec-131">5.10 generate via pdf</a></h3>


<h4><a name="sec-132">5.10.1 what</a></h4>

<ul>
<li>signup form<br/>
</li>
<li>descriptions<br/>
</li>
</ul>
<h4><a name="sec-133">5.10.2 how</a></h4>

<ul>
<li>tcpdf! it seems to work<br/>
</li>
</ul>
<h3><a name="sec-134">5.11 make all monetary fields NOT NULL default 0!</a></h3>


<h4><a name="sec-135">5.11.1 be careful though, it might break stuff. i.e. the model, required validation</a></h4>


<h2><a name="sec-136">6 bugfixen</a></h2>


<h3><a name="sec-137">6.1 in paid, why are cancelleds payments not showing up at all?</a></h3>

<p>is this still happening?
</p>
<h3><a name="sec-138">6.2 they WERE paid. only returned checks shouldn't show up.</a></h3>

<p>or maybe they should, just not in totals?
</p>
<h3><a name="sec-139">6.3 chozen does not like being provided with arrays from sql finds</a></h3>

<p>it makes the width of the box only as wide as teh FIRST item.
i tried dataprovider but it did not help
</p>
<h4><a name="sec-140">6.3.1 it sends the right stuff, but no search is actually occurring</a></h4>


<h3><a name="sec-141">6.4 oh crap. how to deal with partial refunds???</a></h3>

<p>i.e. waitlist? or a cancellation of only ONE class, not all?
or late refunds
DO I NEED TO TRACK REFUND CHECKS?
</p>

<h2><a name="sec-142">7 must have for NEXT YEAR:</a></h2>


<h3><a name="sec-143">7.1 need some way to track the current school year.</a></h3>


<h4><a name="sec-144">7.1.1 yes, i remember now!!!! it took today's date, calculated month!</a></h4>

<p>so based on where you were in the calendar, you were this year or next
aha, i think it will be a named scope
</p>
<h3><a name="sec-145">7.2 picklist of STUDENTS could get huge, and need to be pared down</a></h3>


<h4><a name="sec-146">7.2.1 how to determine when kids are no longer in ocean shore??</a></h4>


<h4><a name="sec-147">7.2.2 um, graduate them? when updating grades, if grade &gt; 8, remove</a></h4>


<h4><a name="sec-148">7.2.3 also, grade needs to be updated every year somehow</a></h4>


<h4><a name="sec-149">7.2.4 current flag?</a></h4>


<h3><a name="sec-150">7.3 i will DEFINITELY need some kind of de-duping system</a></h3>


<h4><a name="sec-151">7.3.1 like i had to do for the coop. it'll have to happen.</a></h4>




<h2><a name="sec-152">8 STUCK</a></h2>


<h3><a name="sec-153">8.1 student parentt relaton for user signin</a></h3>


<h4><a name="sec-154">8.1.1 so a parent would be a user, and it would have to be tied to some # of students</a></h4>


<h4><a name="sec-155">8.1.2 that is REALLY HARD, how do you map them conceptually?</a></h4>


<h3><a name="sec-156">8.2 open questions</a></h3>


<h4><a name="sec-157">8.2.1 how do you know who to write the check to (from that report)?</a></h4>

<p>wtf does that actually mean?
</p>
<h4><a name="sec-158">8.2.2 will you have a case where the materials fee is NOT PER CLASS</a></h4>

<p>i.e. per year?
</p>


<h3><a name="sec-159">8.3 student payment status, i.e. enrollment with payment status</a></h3>


<h3><a name="sec-160">8.4 ok, forms starting to make sense</a></h3>

<p>for adding a check from student or class, DO NOT NEED TO SPLIT IT
hell, i alredy know the student, class, AND amount! 
just a single line, try cform builder!
and, i can not bother with a popup for check
hell, i can have an ajax popup for splits.
make that form optional for create, but NOT optional for editing
for adding payment through class or instructor, do NOT probably need it.
ask heidi about that one tho. maybe redirect for now.
for adding check through checks, put a tabular input!
keep it simple. js to add/remove rows.
for adding a payment through checks, will need tabular input
for adding a STUDENT to a class, just do one form with both models!
what if the students are already in there? it's just a signup.
most will be.
if not, then an entry?
</p>
<h2><a name="sec-161">9 FOR NON-ADMIN USER LOGIN</a></h2>


<h2><a name="sec-162">10 BELOW THE LINE</a></h2>


<h3><a name="sec-163">10.1 maybe make location a link column, not let them be in same place</a></h3>



<h3><a name="sec-164">10.2 try editable datatable!</a></h3>

<p>go back and replace many_many and advanced with has_many and with-related
requirementtype
instructortype
</p>

<h3><a name="sec-165">10.3 expenses really do need to be assigned to classes (but not students)</a></h3>


<h3><a name="sec-166">10.4 have a checkbox on income page to select which classes to pay</a></h3>



<h3><a name="sec-167">10.5 visual show/add meeting dates</a></h3>

<p>a very quick datepicker adder!
just a date, not hidden, and boom, it adds, maybe even ajaxy.
in the meetingdates, join to school calendar and show that stuff!
</p>

<h3><a name="sec-168">10.6 new student wizard really. ajaxy: class-&gt;student-&gt;import-&gt;signup</a></h3>



<h3><a name="sec-169">10.7 finish the relational mappings</a></h3>


<h4><a name="sec-170">10.7.1 a way to create/edit/save a dependent model with ONE field in relation</a></h4>

<p>or a FEW maybe
use tom__'s stuff i think
a common pattern, for a few important things
income
expense
signup
instructorassignmeent
requirementstatus
</p>
<h4><a name="sec-171">10.7.2 gui splits for income/expense</a></h4>

<p>for now handle it like instructors
but the data entry would be way too complicated that way
</p>


<h3><a name="sec-172">10.8 autoppopulate the check when adding</a></h3>

<p>when adding well, i guess, when adding subthings
</p>
<h3><a name="sec-173">10.9 how to handle teachers who are students?</a></h3>

<p>reflextitve relation. dammit. they're not teachers of THIS
</p>
<h2><a name="sec-174">11 open questions</a></h2>

<p class="author"> Author: lken
<a href="mailto:lken@aieee.restivo.org">&lt;lken@aieee.restivo.org&gt;</a>
</p>
<p class="date"> Date: 2012/01/23 02:55:42 PM</p>
</body>
</html>
